<html>

<head>
  <script src="..\lib\BasicShape.js"></script>
  <script src="..\lib\Canvas.js"></script>
  <script src="..\lib\Calc.js"></script>
  <script src="..\lib\Const.js"></script>
  <script src="..\lib\Primitives.js"></script>
  <script src="..\lib\ArcShapes.js"></script>
  <script src="..\lib\Vector.js"></script>
  <script src="..\lib\Outline.js"></script>
  <script src="..\lib\PoligonShapes.js"></script>
  <script src="..\lib\MouseTouchTracker.js"></script>

  <script src="..\lib\test\ut_Obj.js"></script>
  <script src="..\lib\test\ut_Angles.js"></script>
  <script src="..\lib\test\ut_Calc.js"></script>
  <script src="..\lib\test\ut_Shapes.js"></script>
  <script src="..\lib\test\ut_Vector.js"></script>
  <script src="..\lib\test\ut_primitives.js"></script>
</head>


<body">
  <canvas id="canvas" style="border: 1px solid" width="600" height="300"></canvas>
  <script>

    function isHit(shape, x, y) {
      if (shape.constructor.name === 'circle') {
        let dx = shape.x - x;
        let dy = shape.y - y;
        if (dx * dx + dy * dy < shape.radius * shape.radius) {
          return true
        }
      } else {
        if (x > shape.x && y > shape.y && x < shape.x + shape.width && y < shape.y + shape.height) {
          return true;
        }
      }

      return false;
    }

    let canvas = document.getElementById('canvas');
    let ctx = canvas.getContext('2d');
    let beginX = 0;
    let beginY = 0;

    let rectangle1 = new Rectangle(50, 50, 100, 100, '#00FF00');
    rectangle1.render(ctx);

    let circle1 = new Circle(200, 140, 50, '#F00000');
    circle1.render(ctx);

    cc = new CircleComposite(155, 155, 95);
      cc.render(ctx, 1);


    let mtt = new MouseTouchTracker(canvas,
      function (evtType, x, y) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        switch (evtType) {

          case 'down':
            beginX = x;
            beginY = y;
            rectangle1.isDragging = isHit(rectangle1, x, y);
            circle1.isDragging = isHit(circle1, x, y);
            break;

          case 'up':
            rectangle1.isDragging = false;
            circle1.isDragging = false;
            break;

          case 'move':
            let dx = x - beginX;
            let dy = y - beginY;
            beginX = x;
            beginY = y;

            if (rectangle1.isDragging) {
              rectangle1.x += dx;
              rectangle1.y += dy;
            }

            if (circle1.isDragging) {
              circle1.x += dx;
              circle1.y += dy;
            }
            break;
        }

        circle1.render(ctx);
        rectangle1.render(ctx);
      }
    );

  </script>
  </body>

</html>