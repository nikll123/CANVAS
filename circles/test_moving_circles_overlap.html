<html>

<head>
</head>


<body onLoad="draw()">
  <canvas id="canvas" style="border: 1px solid" width="600" height="600"></canvas>
  <script src="classes.js"></script>
  <script src="MouseTouchTracker.js"></script>

  <script>

    var canvas = document.getElementById('canvas');
    var ctx = canvas.getContext('2d');
    var startX = 0;
    var startY = 0;

    var circle1 = new Circle(220, 190, 50);
    var circle2 = new Circle(280, 260, 80);

    console.debug(circle1.toString());
    console.debug(circle2.toString());

    function draw() {
      ctx.clearRect(0, 0, canvas.clientWidth, canvas.clientHeight)
      circle1.render(ctx, 1);
      circle2.render(ctx, 1);

      [angle1_start, angle1_stop, angle2_start, angle2_stop] = Calc.circleOverlap(circle1, circle2);

      // console.debug('a1 ' + angle1_start + ' a2 ' + angle1_stop );

      let arc1 = new Arc(circle1.points[0].x, circle1.points[0].y, circle1.radius, angle1_stop, angle1_start);
      let arc2 = new Arc(circle2.points[0].x, circle2.points[0].y, circle2.radius, angle2_stop, angle2_start);
      arc1.render(ctx, 5, '#FF0000');
      arc2.render(ctx, 5, '#FF0000');

      ctx.beginPath();
      ctx.moveTo(circle1.points[0].x, circle1.points[0].y)
      ctx.lineTo(circle2.points[0].x, circle2.points[0].y)
      ctx.stroke();

      window.requestAnimationFrame(draw);
    }

    var mtt = new MouseTouchTracker(canvas,
      function (evtType, x, y) {                         // callback 
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        switch (evtType) {

          case 'down':
            startX = x;
            startY = y;
            circle1.startDrugIfPointIsInside(x, y);
            circle2.startDrugIfPointIsInside(x, y);
            break;

          case 'up':
            circle1.stopDrag();
            circle2.stopDrag();
            break;

          case 'move':
            var dx = x - startX;
            var dy = y - startY;
            startX = x;
            startY = y;

            circle1.moveIfDragging(dx, dy);
            circle2.moveIfDragging(dx, dy);
            break;
        }
      }
    );

  </script>
</body>

</html>