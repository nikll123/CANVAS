<html>

<head>
  <script src="..\BasicShape.js"></script>
  <script src="..\Canvas.js"></script>
  <script src="..\Calc.js"></script>
  <script src="..\CalcCross.js"></script>
  <script src="..\Const.js"></script>
  <script src="..\Primitives.js"></script>
  <script src="..\ArcShapes.js"></script>
  <script src="..\Vector.js"></script>
  <script src="..\Outline.js"></script>
  <script src="..\PoligonShapes.js"></script>
  <script src="..\MouseTouchTracker.js"></script>

  <script src="..\test\ut_Obj.js"></script>
  <script src="..\test\ut_Angles.js"></script>
  <script src="..\test\ut_Calc.js"></script>
  <script src="..\test\ut_Shapes.js"></script>
  <script src="..\test\ut_Vector.js"></script>
  <script src="..\test\ut_primitives.js"></script>
</head>

<body onload="draw()">
  <div>
    <input type="checkbox" id="chkDebugMode" name="Draft">
    <label for="Draft">Draft</label>
    <input type="checkbox" id="chkShowDetails" name="Details">
    <label for="Details">Details</label>
  </div>

  <script>
    debugMode = false;
    let objDebugMode = document.querySelector('input[id="chkDebugMode"]');
    objDebugMode.addEventListener('change', () => {
      debugMode = objDebugMode.checked;
    })

    showDetails = false;
    let objShowDetails = document.querySelector('input[id="chkShowDetails"]');
    objShowDetails.addEventListener('change', () => {
      showDetails = objShowDetails.checked;
    })
  </script>

  <canvas id="canvas" style="border: 1px solid" width="600" height="600"></canvas>

  <script>
    let canvas = document.getElementById('canvas');
    let ctx = canvas.getContext('2d');

    function draw() {
      Canvas.clearAll(ctx);
      Canvas.grid(ctx);

      let objs = [];

      let c1 = new CircleComposite(200, 200, 100, [ANGLE_DVA_PI], CCW, 'c1');
      let l1 = new Vector(100, 50, 170, 350, 'v1');
      [relType, angleRes, x1, y1, x2, y2] = CalcCross.crossCircleVector(ctx, c1, l1);
      c1.setAngles([angleRes]);
      objs.push(c1);
      objs.push(l1);

      let c2 = new CircleComposite(450, 200, 100, [ANGLE_DVA_PI], CW, 'c2');
      let l2 = new Vector(350, 250, 590, 220, 'l2');
      [relType, angleRes, x1, y1, x2, y2] = CalcCross.crossCircleVector(ctx, c2, l2);
      c2.setAngles([angleRes]);
      objs.push(c2);
      objs.push(l2);

      let c3 = new CircleComposite(200, 500, 90, [ANGLE_DVA_PI], CCW, 'c3');
      let l3 = new Vector(100, 450, 320, 530, 'l3');
      [relType, angleRes, x1, y1, x2, y2] = CalcCross.crossCircleVector(ctx, c3, l3);
      c3.setAngles([angleRes]);
      objs.push(c3);
      objs.push(l3);

      let c4 = new CircleComposite(480, 500, 70, [ANGLE_DVA_PI], CW, 'c4');
      let l4 = new Vector(400, 420, 480, 470, 'l4');
      [relType, angleRes, x1, y1, x2, y2] = CalcCross.crossCircleVector(ctx, c4, l4);
      c4.setAngles([angleRes]);
      objs.push(c4);
      objs.push(l4);

      for (let i = 0; i < objs.length; i++) {
        if (debugMode)
          objs[i].draft(ctx);
        else
          objs[i].render(ctx, 1);

        if (showDetails)
          objs[i].showDetails(ctx);
      }

      if (showDetails)
        l4.showDetails(ctx);

      window.requestAnimationFrame(draw);
    }
  </script>
</body>

</html>