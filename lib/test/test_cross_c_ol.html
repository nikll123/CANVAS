<html>

<head>
  <script src="..\BasicShape.js"></script>
  <script src="..\Canvas.js"></script>
  <script src="..\Calc.js"></script>
  <script src="..\Const.js"></script>
  <script src="..\Primitives.js"></script>
  <script src="..\ArcShapes.js"></script>
  <script src="..\Outline.js"></script>
  <script src="..\PoligonShapes.js"></script>
  <script src="..\MouseTouchTracker.js"></script>

  <script src="..\test\ut_Obj.js"></script>
  <script src="..\test\ut_Angles.js"></script>
  <script src="..\test\ut_Calc.js"></script>
  <script src="..\test\ut_Shapes.js"></script>
  <script src="..\test\ut_primitives.js"></script>
</head>

<body onload="draw()">

  <div>
    <input type="checkbox" id="chkDebugMode" name="Draft">
    <label for="Draft">Draft</label>
    <input type="checkbox" id="chkShowDetails" name="Details">
    <label for="Details">Details</label>
  </div>

  <script>
    debugMode = false;
    let objDebugMode = document.querySelector('input[id="chkDebugMode"]');
    objDebugMode.addEventListener('change', () => {
      debugMode = objDebugMode.checked;
    })

    showDetails = false;
    let objShowDetails = document.querySelector('input[id="chkShowDetails"]');
    objShowDetails.addEventListener('change', () => {
      showDetails = objShowDetails.checked;
    })
  </script>

  <canvas id="canvas" style="border: 1px solid" width="600" height="600"></canvas>

  <script>
    let canvas = document.getElementById('canvas');
    let ctx = canvas.getContext('2d');

    function draw() {
      Canvas.clearAll(ctx);
      Canvas.grid(ctx);

      let c = new CircleCombo(100, 400, 100, [new Angle(0, DVA_PI)], 'c1');
      let c2 = new CircleCombo(400, 100, 80, [new Angle(0, DVA_PI)], 'c2');
      let c3 = new CircleCombo(420, 420, 100, [new Angle(0, DVA_PI)], 'c3');
      c.render(ctx);
      c2.render(ctx);
      c3.render(ctx);
      c.showDetails(ctx);
      let ol = createBgShape(ctx);
      ol.showDetails(ctx);
      c.setAngles(Calc.crossCircleOutLine(c, ol));
      c.render(ctx,3);
      c2.setAngles(Calc.crossCircleOutLine(c2, ol));
      c2.render(ctx,3);
      c3.setAngles(Calc.crossCircleOutLine(c3, ol));
      c3.render(ctx,3);
      window.requestAnimationFrame(draw);
    }

    function createBgShape(ctx) {
      ol = new Outline([], 'olShape');
      ol.push(new Vector(200, 50, 500, 50));
      ol.push(new Arc(500, 100, 50, new Angle(3 * PI / 2, DVA_PI)));
      ol.push(new Vector(550, 100, 550, 400));
      ol.push(new Vector(550, 400, 400, 550));
      ol.push(new Vector(400, 550, 150, 550));
      ol.push(new Arc(100, 500, 50, new Angle(PI / 2, PI)));
      ol.push(new Vector(50, 500, 50, 200));
      ol.push(new Arc(50, 50, 150, new Angle(PI / 2, 0), CCW));
      ctx.save();
      ctx.globalAlpha = 0.5;
      ctx.shadowColor = '#AAAAAA'
      ctx.shadowOffsetX = 10;
      ctx.shadowOffsetY = 10;
      ctx.shadowBlur = 8;
      ol.render(ctx, 1, DEFAULT_COLOR, "#FF9999");
      ctx.restore();
      return ol;
    }

  </script>
</body>

</html>